@model ML.Editorial
@{
    ViewData["Title"] = "GetAll";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h2>Autores</h2>
        </div>
    </div>
    <hr />

    <div class="row">
        <div class="col-md-12">
            <button type="button" class="btn btn-success" id="btnAdd">+</button>
        </div>
    </div>
    <br />

    @if (Model.Editoriales != null)
    {
        <div class="row">
            <div class="col-md-12 table-responsive">
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center">Editar</th>
                            <th class="text-center" hidden>IdEditorial</th>
                            <th class="text-center">Nombre Editorial</th>
                            <th class="text-center">Calle</th>
                            <th class="text-center">Número Interior</th>
                            <th class="text-center">Número Exterior</th>
                            <th class="text-center">Colonia</th>
                            <th class="text-center">Codigo Postal</th>
                            <th class="text-center">Municipio</th>
                            <th class="text-center">Estado</th>
                            <th class="text-center">País</th>
                            <th class="text-center">Eliminar</th>
                        </tr>
                    </thead>
                    <tbody id="tBodyAutor">
                        @foreach (ML.Editorial editorial in Model.Editoriales)
                        {
                            <tr>
                                <td><button class="btn btn-warning">Editar</button></td>
                                <td>@editorial.IdEditorial</td>
                                <td>@editorial.Nombre</td>
                                <td>@editorial.Direccion.Calle</td>
                                <td>@editorial.Direccion.NumeroInterior</td>
                                <td>@editorial.Direccion.NumeroExterior</td>
                                <td>@editorial.Direccion.Colonia.Nombre</td>
                                <td>@editorial.Direccion.Colonia.CodigoPostal</td>
                                <td>@editorial.Direccion.Colonia.Municipio.Nombre</td>
                                <td>@editorial.Direccion.Colonia.Municipio.Estado.Nombre</td>
                                <td>@editorial.Direccion.Colonia.Municipio.Estado.Pais.Nombre</td>
                                <td><button class="btn btn-danger">Eliminar</button></td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
    else
    {
        <div class="alert alert-danger" role="alert">
            @ViewBag.Error
        </div>
    }
</div>

<div class="container">
    @using (Html.BeginForm("Form", "Autor", FormMethod.Post, new { enctype = "multipart/form-data", @id = "myForm" }))
    {
        <div class="modal fade" id="modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel">Editorial</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                @Html.LabelFor(model => model.IdEditorial, null, new { @style = "display: none;" })
                                @Html.TextBoxFor(model => model.IdEditorial, new { @style = "display: none;", @id = "txtIdEditorial" })
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.LabelFor(model => model.Nombre)
                                @Html.TextBoxFor(model => model.Nombre, new { @class = "form-control", @id = "txtNombre" })
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.LabelFor(model => model.Direccion.IdDireccion, new { @class = "hidden" })
                                @Html.TextBoxFor(model => model.Direccion.IdDireccion, new { @class = "hidden" })
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.Colonia.Municipio.Estado.Pais.Nombre, new { @class = "control-label" })
                                @if (Model.Direccion.Colonia.Municipio.Estado.Pais.Paises == null)
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.Estado.Pais.IdPais,
                                             new SelectList(string.Empty, "Value", "Text"), "Seleccione un País", new { @id = "ddlPais", @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.Direccion.Colonia.Municipio.Estado.Pais.IdPais, null, new { @class = "text-danger" })
                                }
                                else
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.Estado.Pais.IdPais, new SelectList(Model.Direccion.Colonia.Municipio.Estado.Pais.Paises,
                                             "IdPais", "Nombre"), "Selecciona un País", new { @id = "ddlPais", @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.Direccion.Colonia.Municipio.Estado.Pais.IdPais, null, new { @class = "text-danger" })
                                }
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.Colonia.Municipio.Estado.Nombre, new { @class = "control-label" })
                                @if (Model.Direccion.Colonia.Municipio.Estado.Estados == null)
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.Estado.IdEstado, new SelectList(string.Empty, "Value", "Text"),
                                             "Selecciona un estado", new { @id = "ddlEstado", @class = "form-control" })
                                }
                                else
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.Estado.IdEstado,
                                             new SelectList(Model.Direccion.Colonia.Municipio.Estado.Estados, "IdEstado", "Nombre"), "Selecciona un estado", new { @id = "ddlEstado", @class = "form-control" })
                                }
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.Colonia.Municipio.Nombre, new { @class = "control-label" })
                                @if (Model.Direccion.Colonia.Municipio.Municipios == null)
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.IdMunicipio, new SelectList(string.Empty, "Value", "Text"),
                                             "Selecciona un municipio", new { @id = "ddlMunicipio", @class = "form-control" })
                                }
                                else
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.Municipio.IdMunicipio,
                                             new SelectList(Model.Direccion.Colonia.Municipio.Municipios, "IdMunicipio", "Nombre"), "Selecciona un municipio", new { @id = "ddlMunicipio", @class = "form-control" })
                                }
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.Colonia.Nombre, new { @class = "control-label" })
                                @if (Model.Direccion.Colonia.Municipio.Municipios == null)
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.IdColonia, new SelectList(string.Empty, "Value", "Text"),
                                             "Selecciona un colonia", new { @id = "ddlColonia", @class = "form-control" })
                                }
                                else
                                {
                                    @Html.DropDownListFor(model => model.Direccion.Colonia.IdColonia,
                                             new SelectList(Model.Direccion.Colonia.Colonias, "IdColonia", "Nombre"), "Selecciona un colonia", new { @id = "ddlColonia", @class = "form-control" })
                                }
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                @Html.LabelFor(model => model.Foto)
                                <input type="file" id="fuImagen" name="fuImagen" class="form-control" onchange="PreviewImage(event)" />
                                <br />
                                <div id="cargarFoto">
                                    @if (Model.Foto == null)
                                    {
                                        <img src="/Images/userDefault.jpg" id="imgAutor" width="150px" height="150px" />
                                    }
                                    else
                                    {
                                        <img src="data:image/png;base64, @Convert.ToBase64String(Model.Foto)" id="imgAutor" width="150px" height="150px" />
                                    }
                                </div>
                                @Html.HiddenFor(model => model.Foto)
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.Calle)
                                @Html.TextBoxFor(model => model.Direccion.Calle, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                @Html.Label("*", new { @style = "color: red;" })
                                @Html.LabelFor(model => model.Direccion.NumeroInterior)
                                @Html.TextBoxFor(model => model.Direccion.NumeroInterior, new { @class = "form-control", @onblur = "return soloNumerosyLetras(event, 'lblNumeroInterior')" })
                                <label id="lblNumeroInterior"></label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        <button type="button" class="btn btn-success" id="btnGuardar">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
    }
</div>


